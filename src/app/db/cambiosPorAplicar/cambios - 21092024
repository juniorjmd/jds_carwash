
CREATE   OR REPLACE VIEW `vw_inv_categorias_vendidos` AS with `categoriasVendidas` as (select min(`vw_productos_vendidos`.`firstDate`) AS `firstDate`,max(`vw_productos_vendidos`.`lastDate`) AS `lastDate`,`vw_productos_vendidos`.`idCategoria` AS `idCategoria` from `vw_productos_vendidos` group by `vw_productos_vendidos`.`idCategoria`) select `inv_categorias`.`id` AS `id`,`inv_categorias`.`idPadreCategoria` AS `idPadreCategoria`,`inv_categorias`.`letra` AS `letra`,`inv_categorias`.`nombre` AS `nombre`,`inv_categorias`.`descripcion` AS `descripcion`,`inv_categorias`.`tipo` AS `tipo`,`inv_categorias`.`contador` AS `contador`,`inv_categorias`.`tipo_descripcion` AS `tipo_descripcion`,`inv_categorias`.`usuario_creacion` AS `usuario_creacion`,`inv_categorias`.`usuario_edicion` AS `usuario_edicion`,`inv_categorias`.`fecha_creacion` AS `fecha_creacion`,`inv_categorias`.`fecha_actualizacion` AS `fecha_actualizacion`,coalesce(`inv_categorias`.`idCuentaContable`,0) AS `idCuentaContable`,coalesce(`cnt_cuentas`.`nombre_cuenta`,'NA') AS `NombreCuentaContable`,json_object('id',`inv_categorias`.`id`,'idPadreCategoria',`inv_categorias`.`idPadreCategoria`,'letra',`inv_categorias`.`letra`,'nombre',`inv_categorias`.`nombre`,'descripcion',`inv_categorias`.`descripcion`,'tipo',`inv_categorias`.`tipo`,'contador',`inv_categorias`.`contador`,'tipo_descripcion',`inv_categorias`.`tipo_descripcion`,'usuario_creacion',`inv_categorias`.`usuario_creacion`,'usuario_edicion',`inv_categorias`.`usuario_edicion`,'fecha_creacion',`inv_categorias`.`fecha_creacion`,'fecha_actualizacion',`inv_categorias`.`fecha_actualizacion`,'name_usuario_creacion',`creador`.`nombreCompleto`,'name_usuario_edicion',`editor`.`nombreCompleto`,'nombre_estado',`estado`.`nombre_estado`,'idCuentaContable',coalesce(`inv_categorias`.`idCuentaContable`,0),'NombreCuentaContable',coalesce(`cnt_cuentas`.`nombre_cuenta`,'NA'),'firstDate',`categoriasVendidas`.`firstDate`,'lastDate',`categoriasVendidas`.`lastDate`) AS `obj` from (((((`inv_categorias` join `categoriasVendidas` on((`inv_categorias`.`id` = `categoriasVendidas`.`idCategoria`))) left join `usuarios` `creador` on((`creador`.`ID` = `inv_categorias`.`usuario_creacion`))) left join `usuarios` `editor` on((`editor`.`ID` = `inv_categorias`.`usuario_edicion`))) left join `estado_registro` `estado` on((`estado`.`id` = `inv_categorias`.`tipo`))) left join `cnt_cuentas` on((`cnt_cuentas`.`id_cuenta` = `inv_categorias`.`idCuentaContable`)));
